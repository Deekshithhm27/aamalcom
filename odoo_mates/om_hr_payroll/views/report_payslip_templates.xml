<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_payslip">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.external_layout">
                    <div class="page">

                        <!-- Header Section -->
                        <div class="row" style="margin-bottom: 20px;">
                            <div class="col-6">
                                <img t-if="o.company_id.logo"
                                     t-att-src="'data:image/png;base64,%s' % o.company_id.logo"
                                     style="max-height: 80px;"/>
                            </div>
                        </div>

                        <!-- Employee Information -->
                        <table class="table" style="width: 100%; border: 2px solid #000; border-collapse: collapse;">
                            <tr style="background-color: #f0f0f0;">
                                <td style="border: 2px solid #000; padding: 6px;"><strong>Name</strong></td>
                                <td style="border: 2px solid #000; padding: 6px;"><span t-field="o.employee_id.name"/></td>
                                <td style="border: 2px solid #000; padding: 6px;"><strong>Designation</strong></td>
                                <td style="border: 2px solid #000; padding: 6px;"><span t-field="o.employee_id.job_id.name"/></td>
                            </tr>
                            <tr>
                                <td style="border: 2px solid #000; padding: 6px;"><strong>Email</strong></td>
                                <td style="border: 2px solid #000; padding: 6px;"><span t-field="o.employee_id.work_email"/></td>
                                <td style="border: 2px solid #000; padding: 6px;"><strong>Identification No</strong></td>
                                <td style="border: 2px solid #000; padding: 6px;"><span t-field="o.identification_no"/></td>
                            </tr>
                            <tr style="background-color: #f0f0f0;">
                                <td style="border: 2px solid #000; padding: 6px;"><strong>Bank Name</strong></td>
                                <td style="border: 2px solid #000; padding: 6px;"><span t-field="o.bank_name"/></td>
                                <td style="border: 2px solid #000; padding: 6px;"><strong>IBAN</strong></td>
                                <td style="border: 2px solid #000; padding: 6px;"><span t-field="o.bank_iban"/></td>
                            </tr>
                            <tr>
                                <td style="border: 2px solid #000; padding: 6px;"><strong>Iqama No</strong></td>
                                <td style="border: 2px solid #000; padding: 6px;"><span t-field="o.iqama_no"/></td>
                                <td style="border: 2px solid #000; padding: 6px;"><strong>Date From</strong></td>
                                <td style="border: 2px solid #000; padding: 6px;"><span t-field="o.date_from"/></td>
                            </tr>
                            <tr style="background-color: #f0f0f0;">
                                <td style="border: 2px solid #000; padding: 6px;"><strong>Date To</strong></td>
                                <td colspan="3" style="border: 2px solid #000; padding: 6px;"><span t-field="o.date_to"/></td>
                            </tr>
                        </table>

                        <!-- Payslip Title -->
                        <h3 style="text-align: center; margin: 25px 0; text-transform: uppercase; 
                                   border-bottom: 2px solid #000; display: inline-block; 
                                   padding-bottom: 5px; font-weight: bold; width: 100%;">
                            Payslip for the Month of 
                            <t t-esc="o.date_from.strftime('%B %Y') if o.date_from else ''"/>
                        </h3>

                        <!-- Payslip Lines -->
                        <table class="table" style="width: 100%; border: 2px solid #000; border-collapse: collapse;">
                            <thead style="background-color: #dcdcdc;">
                                <tr>
                                    <th style="border: 2px solid #000; padding: 8px;">Name</th>
                                    <th style="border: 2px solid #000; padding: 8px;">Amount</th>
                                    <th style="border: 2px solid #000; padding: 8px;">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="o.line_ids.filtered(lambda line: line.appears_on_payslip)" t-as="line">
                                    <td style="border: 2px solid #000; padding: 6px;"><span t-field="line.name"/></td>
                                    <td style="border: 2px solid #000; padding: 6px;">
                                        <span t-esc="line.amount"
                                              t-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}'/>
                                    </td>
                                    <td style="border: 2px solid #000; padding: 6px;">
                                        <span t-esc="line.total"
                                              t-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}'/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Footer Section (Company Seal) -->
                        <div style="margin-top: 50px; text-align: right;">
                            <img t-if="o.company_id.seal"
                                 t-att-src="'data:image/png;base64,%s' % o.company_id.seal"
                                 style="max-height: 100px; opacity: 0.9;"/>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>
